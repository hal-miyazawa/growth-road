// src/types/models.ts

/**
 * =========================
 * Growth Road / DBå‰æãƒ¢ãƒEƒ«Eˆãƒ•ãƒ­ãƒ³ãƒˆç”¨EE
 * =========================
 *
 * â–¼ã“ã“ã¾ã§ã®è¨­è¨ˆãEè¦ç‚¹Eˆè¶E¾ã¨ã‚E¼E
 * 1) DBã¯ labels / projects / tasks ã®3ãƒEEãƒ–ãƒ«æƒ³å®šã€E
 * 2) ã‚¿ã‚¹ã‚¯ã¯ project_id / label_id / parent_task_id ã‚ENULL è¨±å®¹ã€E
 * 3) ç·åˆç”»é¢EEashboardE‰ãEè¡¨ç¤ºãƒ«ãƒ¼ãƒ«ã¯2ç¨®é¡ï¼E
 *    - project_id ãŒã‚ã‚‹ã‚¿ã‚¹ã‚¯Ešå„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€Œä»ŠãE1ä»¶ã ã‘ã€ã‚’è¡¨ç¤ºã—ã¦é€²ã‚ã¦ãE
 *    - project_id ãENULL ã®ã‚¿ã‚¹ã‚¯Ešå˜ä½“ã‚¿ã‚¹ã‚¯æ‰±ãE§ã€æœªå®ŒäºEE â€œåEéƒ¨è¡¨ç¤ºâ€Eã™ã‚‹
 *
 * 4) ã€Œå­ã‚¿ã‚¹ã‚¯ã‚’æŒã¤è¦ªã‚¿ã‚¹ã‚¯ã€ãE â€œãEãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŒ–â€Eã§ãã‚‹ã€E
 *    ä¾‹ï¼‰å­¦ç¿’ãEãƒ­ã‚¸ã‚§ã‚¯ãƒˆåEã« 1,2,3,4 ãŒã‚ã‚Šã€EãŒå­E11,12,13,14)ã‚’æŒã¤å ´åˆã€E
 *        parent_task_id ã‚’ä½¿ã£ã¦éšå±¤ã‚’è¡¨ç¾ã™ã‚‹EE1..ã® parent_task_id = 2E‰ã€E
 *
 * 5) è¡¨ç¤ºé EEã€Œå¹³å¦åŒEFlatten)ã€ã§æ±ºã‚ã‚‹æƒ³å®šã€E
 *    ãƒ«ãƒ¼ãƒˆãEé E•ªã¯ order_index ã§ 1 â†E2 â†E3 â†E4ã€E
 *    ãŸã ãEâ€œå­ã‚’æŒã¤è¦ª(2)â€Eã¯è¡¨ç¤ºã›ãšã€ãã®ä½ç½®ã«å­E11..14)ã‚’å·®ã—è¾¼ã‚€ã€E
 *    â†Eè¡¨ç¤ºé E¼E, 11, 12, 13, 14, 3, 4
 *
 * 6) order_index ã¯ã€ŒåŒä¸€(project_id, parent_task_id)å†E€ã§ 0..n-1 ã‚’ç¶­æŒã™ã‚‹å‰æã€E
 *    ã‚¿ã‚¹ã‚¯è¿½åŠ /å‰Šé™¤/é E•ªå¤‰æ›´æ™‚ã«ã¯ã€å¿Ešæ•´å½¢(å†æ¡ç•ª)é–¢æ•°ã‚’é€šã—ã¦
 *    æ¬ ç•ªãƒ»é‡è¤EŒçµ¶å¯¾èµ·ããªãE‚ˆãE«ã™ã‚‹ã€E
 *
 * 7) é€²æ—ãEæŒã¡æ–¹ã«ã¤ãE¦Eˆç¾åœ¨ã®æ–¹é‡ï¼E
 *    - ç¾çŠ¶ã¯ Project ã« current_order_index ã‚’æŒã¤(Aæ¡Eã€E
 *      â€»å°E¥çšE«éšå±¤ã®é€²è¡Œã¾ã§ç¢ºå®Ÿã«æ‰±ãEªã‚Ecurrent_task_id æ–¹å¼ãEæ–¹ãŒå¼·ãE€E
 *      ãŸã ã—ç¾æ®µéšã§ã¯ Aæ¡ˆã§é€²ã‚ã‚‹ã€E
 */

/**
 * IDã¯å°E¥DBã§ã¯ UUID ã‚’æƒ³å®šã€E
 * ãƒ•ãƒ­ãƒ³ãƒˆã§ã¯ string ã«çµ±ä¸€ã—ã¦ãŠãã¨ã€å¾Œã§APIå°åEã—ã¦ã‚‚å´©ã‚Œã«ãã„ã€E
 */
export type ID = string;

/**
 * ãƒ©ãƒ™ãƒ«Eˆä»»æ„ï¼E
 * - project / task ã©ã¡ã‚‰ã«ã‚‚ç´ã¥ã‘å¯èƒ½EEULLè¨±å®¹EE
 * - color/icon ã¯UIç”¨ã€‚æœªè¨­å®šã§ã‚‚OKã€E
 */
export type Label = {
  id: ID;
  title: string;
  color: string | null;
  created_at: string; // ISOæ–E­—åEEˆä¾E new Date().toISOString()EE
};

/**
 * ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒE
 * - label_id ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåEä½“ãEè‰²/ã‚«ãƒE‚´ãƒªã«ä½¿ãE¼ˆä»»æ„ï¼E
 * - current_order_index ã¯ã€Œä»Šè¡¨ç¤ºã—ãŸãE‚¿ã‚¹ã‚¯ã® order_indexã€ã‚’è¡¨ãEAæ¡E
 *
 * ä¾‹ï¼‰ãƒ«ãƒ¼ãƒˆéšå±¤ã®è¡¨ç¤ºã‚’é€²ã‚ã‚‹å ´åˆï¼E
 *   current_order_index = 0 â†Eorder_index=0 ã®ã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤º
 *   current_order_index = 1 â†Eorder_index=1 ã®ã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤º
 *
 * â€»æ³¨æ„ï¼E
 *   2ã®ã‚ˆã†ãªã€Œå­ã‚’æŒã¤ã‚¿ã‚¹ã‚¯ã€ã‚’ã©ãE€²ã‚ã‚‹ã‹ï¼ˆå­ã¸æ½œã‚‹/ã‚¹ã‚­ãƒEEã—ã¦æ¬¡ã¸ãªã©E‰ãE
 *   ä»Šå¾Œãƒ­ã‚¸ãƒE‚¯ã§æ±ºã‚ã‚‹ã€‚å°E¥ã¯ current_task_id æ–¹å¼ã«å¯E›ã‚‹å¯èƒ½æ€§ã‚ã‚Šã€E
 */
export type Project = {
  id: ID;
  title: string;
  label_id?: ID | null;

  /**
   * ã“ãEãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€Œç¾åœ¨è¡¨ç¤ºã™ã‚‹æ®µéšã€E
   * - completed ã—ãŸã‚E+1 ã™ã‚‹æƒ³å®šï¼ˆã¾ãšãEã‚·ãƒ³ãƒ—ãƒ«ã«EE
   * - tasks å´ã® order_index ã¯ 0..n-1 ã‚’ç¶­æŒã™ã‚‹å‰æï¼ˆæ¬ ç•ª/é‡è¤E‚’ä½œã‚‰ãªãE¼E
   */
  current_order_index: number;

  created_at: string;
  updated_at: string;
};

/**
 * ã‚¿ã‚¹ã‚¯
 *
 * âœEé‡è¦ä»•æ§˜ï¼ˆã“ã®ãƒ¢ãƒEƒ«ã‚’èª­ã‚“ã ã ã‘ã§è¿·ã‚ãªãEŸã‚ãEèª¬æ˜ï¼E
 *
 * 1) project_id ãENULL ã®ã‚¿ã‚¹ã‚¯ã¯ã€Œå˜ä½“ã‚¿ã‚¹ã‚¯ã€æ‰±ãE€E
 *    â†Eç·åˆç”»é¢ã§ã¯ã€æœªå®ŒäºEªã‚Eâ€œåEéƒ¨è¡¨ç¤ºâ€Eã™ã‚‹EˆãEãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²è¡ŒãEå¯¾è±¡å¤–ï¼‰ã€E
 *
 * 2) parent_task_id ã¯ã€Œã‚µãƒ–ãEãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ã‚’è¡¨ã™ãŸã‚ãEè¦ªå‚çEã€E
 *    ä¾‹ï¼‰å­¦ç¿’ãEãƒ­ã‚¸ã‚§ã‚¯ãƒˆåEã« 1,2,3,4 ãŒã‚ã‚Šã€EãŒå­E11,12,13,14)ã‚’æŒã¤EE
 *        - 11/12/13/14 ã® parent_task_id = 2
 *        - ã“ã‚Œã§ã€Eã®ä¸­ã«11..ãŒã‚ã‚‹ã€ã‚’è¡¨ç¾ã§ãã‚‹
 *
 * 3) order_index ã¯ â€œåŒä¸€(project_id, parent_task_id)å†E€Eã®ä¸¦ã³é E€E
 *    - ãƒ«ãƒ¼ãƒˆéšå±¤Ešparent_task_id=null ã®ä¸­ã§ 0..n-1
 *    - å­éšå±¤Ešparent_task_id=2 ã®ä¸­ã§ 0..n-1EE1..14ã®ä¸¦ã³EE
 *
 * 4) è¡¨ç¤ºé E¼ˆå¹³å¦åŒ–ï¼‰ãEåŸºæœ¬æ–¹é‡ï¼E
 *    - ãƒ«ãƒ¼ãƒˆãEé E•ªã¯ order_index é E
 *    - å­ã‚’æŒã¤è¦ªã‚¿ã‚¹ã‚¯ã¯ã€Œè¦ªã‚’è¡¨ç¤ºã›ãšã€å­ã‚’ããEä½ç½®ã«å·®ã—è¾¼ã‚€ã€E
 *      ä¾‹ï¼E,2,3,4 ã§ 2 ãŒå­ã‚’æŒã¤ â†E1,11,12,13,14,3,4
 *
 * 5) æ¬ ç•ªãƒ»é‡è¤E¯¾ç­–ï¼E
 *    ã‚¿ã‚¹ã‚¯è¿½åŠ /å‰Šé™¤/é E•ªå¤‰æ›´å¾ŒãEã€å¿Ešå†æ¡ç•ªEEormalizeE‰ã—ã¦
 *    åŒä¸€ã‚°ãƒ«ãƒ¼ãƒ—åEã® order_index ã‚E0..n-1 ã«æ•´ãˆã‚‹ã€E
 */
export type Task = {
  id: ID;

  project_id?: ID | null;
  label_id?: ID | null;
  parent_task_id?: ID | null;

  // â˜E¿½åŠ Ešè¦ªEˆã‚°ãƒ«ãƒ¼ãƒ—ï¼‰ç”¨ã‚¿ã‚¹ã‚¯ã€‚ã‚«ãƒ¼ãƒ‰ã«ã¯å‡ºã•ãªãE
  is_group?: boolean;

  order_index: number;
  title: string;
  memo?: string | null;

  completed: boolean;
  completed_at?: string | null;

  is_fixed: boolean;

  created_at: string;
  updated_at: string;
};
